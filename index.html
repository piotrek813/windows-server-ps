<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css">
		<link rel="stylesheet" href="css/termynal.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">

		<style>
			.termynal {
				margin: auto;
				height: 500px;
				overflow-y: scroll;
			}

			.termynal span {
				white-space: pre-wrap;
			}

			.termynal--print {
				height: auto;
				overflow-y: visible;
			}

			.termynal::-webkit-scrollbar {
				width: 10px;
			}

			.termynal::-webkit-scrollbar-track {
				background-color: #373f50;
			}

			.termynal::-webkit-scrollbar-thumb {
				background-color:  #949ba8;
			}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<section data-markdown>
						<textarea data-template>
							# Konfiguracja adresów
						</textarea>
					</section>
					<section>
						<div class="termynal"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="PS C:\Users\Administrator>">netsh interface ipv4 show config</span>
							<span daty-ty>
Configuration for interface "Ethernet"
DHCP enabled:                         Yes
IP Address:                           10.0.2.15
Subnet Prefix:                        10.0.2.0/24 (mask 255.255.255.0)
Default Gateway:                      10.0.2.2
Gateway Metric:                       0
InterfaceMetric:                      25
Statically Configured DNS Servers:    127.0.0.1
Register with which suffix:           Primary only
WINS servers configured through DHCP: None

Configuration for interface "Ethernet 2"
DHCP enabled:                         Yes
IP Address:                           169.254.63.85
Subnet Prefix:                        169.254.0.0/16 (mask 255.255.0.0)
InterfaceMetric:                      25
Statically Configured DNS Servers:    127.0.0.1
Register with which suffix:           Primary only
WINS servers configured through DHCP: None

Configuration for interface "Loopback Pseudo-Interface 1"
DHCP enabled:                         No
IP Address:                           127.0.0.1
Subnet Prefix:                        127.0.0.0/8 (mask 255.0.0.0)
InterfaceMetric:                      75
Statically Configured DNS Servers:    None
Register with which suffix:           Primary only
Statically Configured WINS Servers:   None
							</span>
						</div>
					</section>
					<section>
						<h3>Statyczne adresy</h3>
						<div class="termynal"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<aside class="notes">192.168.0.10 adres komputera <br> 255.255.255.0 maska <br> 192.168.0.1 brama
							</aside>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">netsh interface ipv4 set address name="Ethernet 2" static 192.168.0.10 255.255.255.0 192.168.0.1</span>
						</div>
					</section>
					<section>
						<h3>DHCP</h3>
						<div class="termynal"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>"> netsh interface ipv4 set address name="Ethernet 2" source="dhcp"</span>
						</div>
					</section>
					<section>
						<aside class="notes">index=2 pozwala na ustawienie drugiego dns</aside>
						<h3>DNS</h3>
						<div class="termynal"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">netsh interface ipv4 set dns name="Ethernet" static 127.0.0.1</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">netsh interface ipv4 set dns name="Ethernet" static 8.8.8.8 index=2</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">netsh interface ipv4 set dnsservers name="Ethernet 2" source="dhcp"</span>
						</div>
					</section>
					<section>
						<aside class="notes">/releasedns - Pozwala wykonać aktualizację dzierżawy adresów DHCP oraz rejestrację nazw związanych z systemem DNS w wierszu polecenia <br><br> ipconfig/release adres IP karty sieciowej zostanie wyczyszczony i przekazany do puli na serwerze DHCP<br><br>/renew - pobranie adresu z serwera DHCP</aside>
						<h3>ipconfig</h3>
						<div class="termynal"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">ipconfig /registerdns</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">ipconfig /release</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">ipconfig /renew</span>
						</div>
					</section>
				</section>
				<section>
					<section data-markdown>
						<textarea data-template>
							# Zarządzanie usługami
						</textarea>
					</section>
					<section>
						<aside class="notes"><code>Get-WindowsFeature</code> służy do wyświetlenia wszystkich usług dostępnych na serwerze. <br><br>
							Komenda działa dosłownie jak menadżer z GUI, co zresztą widać. Od razu widzimy przy każdej usłudze parametr „Install State” który informuje nas o stanie usługi. <br><br>
							Jako ciekawostkę można dodać, że komenda działa w całej sieci co znaczy, że możemy ją uruchomić, aby odczytać usługi zainstalowane na dowolnym serwerze. Wystarczy tylko podać jego nazwę oraz poświadczenia, które nam to umożliwią np.:
							<code>Get-WindowsFeature -ComputerName Server1 -Credential server.test.com\administrator</code><br><br>
							Możemy też oczywiście podejrzeć tylko zainstalowane bądź niezainstalowane usługi. Komendy w PowerShellu można praktycznie dowolnie modyfikować: <br>
							<code>Get-WindowsFeature -ComputerName Server | Where InstallState -Eq Installed</code><br>
							<code>Get-WindowsFeature -ComputerName Server | Where InstallState -Eq Available</code><br>
							</aside>
							<img src="img/Get-WindowsFeature.png" alt="">
					</section>
					<section>
						<aside class="notes">Oczywiście samo wyświetlanie serwisów byłoby zupełnie niepotrzebne, jeśli nie moglibyśmy nic z nimi zrobić. Mamy więc kilka komend, które umożliwiają nam zainstalowanie, bądź odinstalowanie usług. <br> <br>
							Ta komedna zainstaluje nam Web-Server czyli… IISa. Instalacja odbędzie się ze wszystkimi dostępnymi funkcjami oraz narzędziami do zarządzania usługą. W ten sposób wprowadzoną komendą można zainstalować usługę na każdym serwerze dostępnym w sieci. Oczywiście po wciśnięciu entera musimy jeszcze podać poświadczenia administratora i gotowe.
						</aside>
						<div class="r-stack">
							<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
								<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">Get-WindowsFeature --whatifInstall-WindowsFeature -Name Web-Server -IncludeAllSubFeature -IncludeManagementTools -ComputerName Server -Credential egzamin\administrator -whatif</span>
							</div>
							<img class="fragment fade-in-then-out" src="img/installation cred.png" alt="">
						</div>
					</section>
					<section>
						<aside class="notes">Oczywiście komendy możemy łączyć. W końcu na tym polegają skrypty w PowerShellu. Spójrzmy na ten przykład. <br> <br>
							Co się dzieje? Wywołujemy komendę <code>Get-WindowsFeature</code>aby wyświetlić wszystkie elementy z przedrostkiem Web-, a następnie wrzucamy je do instalacji na serwerze, z którego wywołujemy polecenie. Proste? Proste. I co najważniejsze – szybsze niż robienie tego przez GUI.
							</aside>
						<div class="termynal ps" data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">Get-WindowsFeature -Name Web-* | Install-WindowsFeature</span>
							<span data-ty="progress" data-ty-progressChar="·"></span>
						</div>
					</section>
					<section>
						<aside class="notes">Odinstalowywanie usług wygląda analogicznie do instalacji. <br>
							Wprowadzona Komenda odinstaluje nam IISa z naszego serwera. Ponownie możemy stosować w tym wypadku case’y, czyli warunkowe wywoływanie skryptu. Spójrzmy na ten przykład: <br> <br>
							<code>Get-WindowsFeature | Where-Object -FilterScript { $_.Installed -Eq $TRUE } | Uninstall-WindowsFeature</code> <br> <br>
							Ta Komenda odinstaluje wszystkie usługi, które są aktualnie zainstalowane na serwerze.
							<br><br>
							</aside>
							<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
								<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">Uninstall-WindowsFeature -Name Web-Server -ComputerName Server -Credential test\administrator
								</span>
							</div>
					</section>
					<section>
						<aside class="notes">Ciekawostką jest, że możemy też kompletnie usunąć jakiekolwiek dane o usłudze z serwera, czego przez GUI zrobić nie można: <br><br>
							Nie radzę tego co prawda próbować, ale jeśli ktoś kiedyś chciałby zażartować sobie ze swojego admina i dostał w ręce jego komputer to… cóż… Ta komenda usunie wszelkie dane z Windows Server o usługach jeszcze niezainstalowanych. Oznacza to, że nie będzie można ich zainstalować bez ponownego pobrania ich z Internetu.
							</aside>
						<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">Get-WindowsFeature | Where-Object -FilterScript { $_.Installed -Eq $FALSE } | Uninstall-WindowsFeature -Remove</span>
						</div>
					</section>
				</section>
				<section>
					<section data-markdown>
						<textarea data-template>
							# Zarządzanie obiektami adds
						</textarea>
					</section>
					<section>
						<aside class="notes">Zarzązanie obiektami chyba najlepiej pokazać na przykładzie. <br> <br> Zaczynamy od stworzenia ou o nazwie IT i kadra <br> <br> Teraz możemy podejżeć ou w domenie i widzimy, że nasze jednostki zostały poprawnie utworzone</aside>
						<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsadd ou "ou=IT, dc=egzamin, dc=local"</span>
							<span data-ty>dsadd succeeded:ou=IT,dc=egzamin,dc=local</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsadd ou "ou=kadra, dc=egzamin, dc=local"</span>
							<span data-ty>dsadd succeeded:ou=kadra,dc=egzamin,dc=local</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsquery ou domainroot</span>
							<span data-ty>"OU=Domain Controllers,DC=egzamin,DC=local"
"OU=IT,DC=egzamin,DC=local"</span>
						</div>
					</section>
					<section>
						<aside class="notes">Teraz dodamy użytkowników... <br><br> Musieliśmy się tyle napisać i narazie mamy tylko jednego Roy, ale teraz możemy szybko edytować tą komednę i... <br><br> mamy dwóch nowych kadrowców kadrowców <br><br> Jeszcze tylko wyjaśnimy szybko co znaczą poszególne parametry: <br> -ln-nazwisko użytkownika <br>-fn-imię użytkownika<br>-upn-login<br>-pwd-hasło<br>-mustchpwd (yes, no)-wymuszenie zmiany hasła przy pierwszym logowaniu<br>-disabled (yes, no)-włączenie lub wyłączenie konta <br>-memberof - podajemy do jakiej grup ma należeć użytkownik</aside>
						<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsadd user "cn=Roy Trenneman,ou=IT,dc=egzamin,dc=local" -fn Roy -ln Trennenman -upn roy -pwd 1qaz@WSX -mustchpwd no -memberof "cn=Administratorzy,cn=Builtin,dc=egzamin,dc=local"</span>
							<span data-ty>dsadd succeeded:cn=Roy Trenneman,ou=IT,dc=egzamin,dc=local</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsadd user "cn=Paul,ou=kadra,dc=egzamin,dc=local" -fn Paul -upn paul -pwd 1qaz@WSX -mustchpwd no</span>
							<span data-ty>dsadd succeeded:cn=Paul,ou=kadra,dc=egzamin,dc=local</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsadd user "cn=John,ou=kadra,dc=egzamin,dc=local" -fn John -upn john -pwd 1qaz@WSX -mustchpwd no</span>
							<span data-ty>dsadd succeeded:cn=John,ou=kadra,dc=egzamin,dc=local</span>
						</div>
					</section>
					<section>
						<aside class="notes">Teraz zajmiemy się poleceniem dsmove. Załóżmy, że chcemy zmienić nazwę jednogo z użytkowników... <br> <br> i gotowe. A teraz jeśli postanowimy zmienić nazwę całej ou na np. sprzedawcy a John przenieść do IT</aside>
						<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsmove "cn=Paul,ou=kadra,dc=egzamin,dc=local" -newname "sir Paul"</span>
							<span data-ty>dsmove succeeded:cn=Paul,ou=kadra,dc=egzamin,dc=local</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsmove "kadra, dc=egzamin,dc=local" -newname "sprzedawcy"</span>
							<span data-ty>dsmove succeeded:ou=kadra,dc=egzamin,dc=local</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsmove "cn=John,ou=sprzedawcy,dc=egzamin,dc=local" -newparent "ou=IT,dc=egzamin,dc=local"</span>
							<span data-ty>dsmove succeeded:cn=John,ou=sprzedawcy,dc=egzamin,dc=local</span>
						</div>
					</section>
					<section>
						<aside class="notes">Za chwile zajmiemy się modyfikacją już istniejących obiektów ale najpierw zobaczmy jak wyświeltić użytkowników. <br> Opcja -filter pozwala na ustawienie parametrów wyszukiwania a -searchbase na określenie gdzie polecenia ma szukać użytkowników. <br><br> Podobnie możemy użyć poleceń: <b>Get-ADOrganizationalUnit</b> i <b>Get-ADGroup</b> do wyświetlenia jednostek organizacyjnych i grup</aside>
						<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">Get-ADUser -filter * -searchbase "ou=IT,dc=egzamin,dc=local"</span>
							<span data-ty>DistinguishedName : CN=Roy Trenneman,OU=IT,DC=egzamin,DC=local
Enabled           : True
GivenName         : Roy
Name              : Roy Trenneman
ObjectClass       : user
ObjectGUID        : c765712b-4f8c-4d39-82e3-9430cb663697
SamAccountName    : Roy Trenneman
SID               : S-1-5-21-1416323974-3321502363-3564335928-1111
Surname           : Trennenman
UserPrincipalName : roy

DistinguishedName : CN=John,OU=IT,DC=egzamin,DC=local
Enabled           : True
GivenName         : John
Name              : John
ObjectClass       : user
ObjectGUID        : 18a2493f-f7d7-4c03-b765-70ea18c00a05
SamAccountName    : John
SID               : S-1-5-21-1416323974-3321502363-3564335928-1113
Surname           :
UserPrincipalName : john</span>
						</div>
					</section>
					<section>
						<aside class="notes">Następnie zajmiemy się modyfikacją obiektów. Składnia polecenia <b>dsmod</b> jest identyczna jak <b>dsadd</b>: dsmod ObjectType DistinguishedName -flaga <br><br>Przykładowo jeśli chcemy zresetować hasła użytkowniką wystarczy, że użyjemy tego polecenia</aside>
						<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsmod user "CN=John,OU=IT,DC=egzamin,DC=local" "CN=Roy Trenneman,OU=IT,DC=egzamin,DC=local" -pwd zaq1@WSX -mustchpwd yes</span>
							<span data-ty>dsmod succeeded:CN=John,OU=IT,DC=egzamin,DC=local
dsmod succeeded:CN=Roy Trenneman,OU=IT,DC=egzamin,DC=local</span>
						</div>
					</section>
					<section>
						<aside class="notes">Na koniec zobaczmy jak usuwać obiekty. Opcja -subtree jest potrzebna kiedy usuwamy ou, które mają zawartość. <br> Wartą do zapamiętania jest flaga -exclude używana ze wspomnianą -subtree. Pozwala nam na szybkie usunięcię objektów z ou zostawiając ja nie naruszoną.</aside>
						<div class="termynal ps"  data-termynal data-ty-typeDelay="40" data-ty-lineDelay="700">
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>">dsrm "OU=sprzedawcy,DC=egzamin,DC=local" -q -subtree</span>
							<span data-ty="input" data-ty-prompt="C:\Users\Administrator>"> dsrm "ou=IT,dc=egzamin,dc=local" -noprompt -subtree -exclude</span>
							<span data-ty>dsrm succeeded:ou=IT,dc=egzamin,dc=local</span>
						</div>
					</section>
				</section>
			</div>
		</div>

		<script src="plugin/termynal.js"></script>
		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>


			const termynals = document.querySelectorAll('.termynal');
			const termynalNodes = [...termynals];
			let params = window.location.search;
			if(!params.includes('print-pdf') && !params.includes('termynal-stop')) {
				termynalNodes.forEach((termynal, i) => {
					 termynal.id=`termynal${i}`;
					 new Termynal(`#${termynal.id}`);
				 })
			} else if(params.includes('print-pdf')){
				termynalNodes.forEach((termynal, i) => {
					 termynal.classList.add('termynal--print');
				 })
			}

			document.addEventListener('keydown', e => {
				if(e.code=="KeyT") {
					let tyStop = 'termynal-stop';
						if(params.includes(tyStop))
							window.location.search = params.replace(tyStop, '');
						else
							window.location.search+=tyStop;
				}
			});
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				showNotes: true,
				// showNotes: "separate-page",

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});

			// Reveal.on('slidechanged', event => {
			// 	termynal = new Termynal('#termynal')
			// })

		</script>
	</body>
</html>
